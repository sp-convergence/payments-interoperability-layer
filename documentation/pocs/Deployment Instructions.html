<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PoC Deployment | Payments Interoperability Layer Documentation</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Payments Interoperability Layer Documentation">
    <meta name="theme-color" content="#00a3ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/payments-interoperability-layer/assets/css/0.styles.43ee56f3.css" as="style"><link rel="preload" href="/payments-interoperability-layer/assets/js/app.53bea330.js" as="script"><link rel="preload" href="/payments-interoperability-layer/assets/js/3.18f6b80e.js" as="script"><link rel="preload" href="/payments-interoperability-layer/assets/js/15.6423f441.js" as="script"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/10.40ad6ec1.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/11.4406c51b.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/12.5c9b93e5.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/13.97695abc.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/14.787ba157.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/16.a54844d6.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/17.ac6e776a.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/18.f569f371.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/19.9c15e520.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/2.c9424017.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/20.e2e8af8d.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/21.b089f7a8.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/22.c5d3cd40.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/23.54b86716.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/24.2a5eea6b.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/4.dd768288.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/5.8bc60e45.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/6.801b443a.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/7.7d6d7340.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/8.bd3e35d7.js"><link rel="prefetch" href="/payments-interoperability-layer/assets/js/9.71a236e4.js">
    <link rel="stylesheet" href="/payments-interoperability-layer/assets/css/0.styles.43ee56f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="custom-layout"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/payments-interoperability-layer/" class="home-link router-link-active"><img src="https://sp-convergence.org/wp-content/uploads/2021/11/cropped-Logotipo1-3.png" alt="Payments Interoperability Layer Documentation" class="logo"> <span class="site-name can-hide">Payments Interoperability Layer Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Documentation</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Concept</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/payments-interoperability-layer/documentation/concept/Overview.html" class="sidebar-link">Overview</a></li><li><a href="/payments-interoperability-layer/documentation/concept/IndividualServices.html" class="sidebar-link">IndividualServices</a></li></ul></section></li><li><a href="/payments-interoperability-layer/documentation/Sequence Diagrams.html" class="sidebar-link">Sequence Diagrams</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Version 0.1.0</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/payments-interoperability-layer/documentation/v0_1_0/" class="sidebar-link">API Specification</a></li><li><a href="/payments-interoperability-layer/documentation/v0_1_0/Data Standards.html" class="sidebar-link">Data Standards</a></li><li><a href="/payments-interoperability-layer/documentation/v0_1_0/Code Directories.html" class="sidebar-link">Code Directories</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Proof of concept implementation</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/payments-interoperability-layer/documentation/pocs/" aria-current="page" class="sidebar-link">PoC Overview</a></li><li><a href="/payments-interoperability-layer/documentation/pocs/G2P.html" class="sidebar-link">Payment via a DFSP interface</a></li><li><a href="/payments-interoperability-layer/documentation/pocs/FHIR.html" class="sidebar-link">Payment via a 3PPI interface</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page custom"> <!----> <div class="theme-default-content content__default"><h1 id="poc-deployment"><a href="#poc-deployment" class="header-anchor">#</a> PoC Deployment</h1> <p>This is a developer guide to building and deploying reports for the reporting REST service that is part of the deployment at the Hub.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><strong>The following contents are for example. This page is under development</strong></p></div> <h2 id="g2p-government-to-person-payment-through-mojaloop-switch"><a href="#g2p-government-to-person-payment-through-mojaloop-switch" class="header-anchor">#</a> G2P (Government to Person) payment through mojaloop switch</h2> <p>This is to demo a G2P payment using the following components</p> <ul><li>DFSP payment manager</li> <li>Mojaloop Testing Toolkit</li></ul> <h3 id="deployment-instructions"><a href="#deployment-instructions" class="header-anchor">#</a> Deployment Instructions</h3> <ul><li>Clone this repository</li> <li>Run all the services with docker-compose<div class="language- extra-class"><pre class="language-text"><code>cd mojaloop-g2p-poc-demo
docker-compose up
</code></pre></div></li></ul> <hr> <p>That’s it, all the services will be deployed.</p> <h3 id="open-the-following-web-pages-to-monitor-the-transaction"><a href="#open-the-following-web-pages-to-monitor-the-transaction" class="header-anchor">#</a> Open the following web pages to monitor the transaction</h3> <ul><li>Mojaloop Testing Toolkit Monitoring: Open the URL http://localhost:6060/admin/monitoring</li></ul> <h3 id="open-first-payee-mobile-app-simulator"><a href="#open-first-payee-mobile-app-simulator" class="header-anchor">#</a> Open first payee mobile app simulator</h3> <ul><li>Payee mobile app simulator: Open the URL http://localhost:6060/payeemobile</li> <li>You should see the mobile app simulator with logo <code>Pink Bank</code></li> <li>Login with username ‘9876543210’ and don’t need password</li> <li>Then you should see the message <code>Welcome Navya Agarwal</code></li></ul> <h3 id="open-second-payee-mobile-app-simulator-in-a-separate-browser-tab-window"><a href="#open-second-payee-mobile-app-simulator-in-a-separate-browser-tab-window" class="header-anchor">#</a> Open second payee mobile app simulator in a separate browser tab / window</h3> <ul><li>Payee mobile app simulator: Open the URL http://localhost:6061/payeemobile</li> <li>You should see the mobile app simulator with logo <code>Green Bank</code></li> <li>Login with username ‘8765432101’ and don’t need password</li> <li>Then you should see the message <code>Welcome Arjun Varma</code></li></ul> <h3 id="executing-disbursement"><a href="#executing-disbursement" class="header-anchor">#</a> Executing disbursement</h3> <ul><li>Execute the following HTTP request either from command line or from postman.<div class="language- extra-class"><pre class="language-text"><code>curl --location --request POST 'http://localhost:3001/disbursement' --header 'Content-Type: application/json' --data-raw '{
  &quot;disbursementId&quot;: &quot;f2957f7a-34c3-11ed-a261-0242ac120002&quot;,
  &quot;note&quot;: &quot;PENSION&quot;,
  &quot;payeeList&quot;: [
      {
          &quot;payeeIdType&quot;: &quot;MSISDN&quot;,
          &quot;payeeIdValue&quot;: &quot;9876543210&quot;,
          &quot;amount&quot;: 2000,
          &quot;currency&quot;: &quot;INR&quot;
      },
      {
          &quot;payeeIdType&quot;: &quot;MSISDN&quot;,
          &quot;payeeIdValue&quot;: &quot;8765432101&quot;,
          &quot;amount&quot;: 3000,
          &quot;currency&quot;: &quot;INR&quot;
      }
  ]
}'
</code></pre></div></li> <li>You should get the ‘COMPLETED’ status in the response.</li> <li>You can check various requests and responses in TTK monitoring page</li> <li>You should see the incoming notification in both payee mobile app simulators</li></ul> <h2 id="thridparty-transfer-in-mojaloop-out-of-a-fhir-invoice"><a href="#thridparty-transfer-in-mojaloop-out-of-a-fhir-invoice" class="header-anchor">#</a> Thridparty transfer in mojaloop out of a fhir invoice</h2> <p>This is to demo a third party transfer using the following components</p> <ul><li>OpenHIM</li> <li>FHIR-Mojaloop OpenHIM Mediator</li> <li>PISP payment manager</li> <li>Mojaloop Testing Toolkit</li></ul> <h3 id="technical-architecture"><a href="#technical-architecture" class="header-anchor">#</a> Technical Architecture</h3> <p><img src="assets/images/fhir-invoice-pisp-poc.png" alt="Technical Architecture Diagram"></p> <h3 id="deployment-instructions-2"><a href="#deployment-instructions-2" class="header-anchor">#</a> Deployment Instructions</h3> <ul><li><p>Clone this repository</p></li> <li><p>Start OpenHIM</p> <div class="language- extra-class"><pre class="language-text"><code>cd openhim
docker-compose up
</code></pre></div></li> <li><p>Now, navigate to your web server and you should see the OpenHIM-console load (eg. <code>http://localhost:9080</code>) and login. The default username and password are:</p> <ul><li>username: <code>root@openhim.org</code></li> <li>password: <code>openhim-password</code></li></ul> <p>You will be prompted to change this. Change the password to <code>123456</code> to match the mediator configuration. If you want any other password, please change the mediator configuration too.</p> <blockquote><p><strong>Note:</strong> You will have problems logging in if your OpenHIM server is still setup to use a self-signed certificate (the default). To get around this you can use the following workaround (the proper way to solve this is to upload a proper certificate into the OpenHIM-core):</p></blockquote> <p>Visit the following link: <code>https://localhost:8080/authenticate/root@openhim.org</code> in Chrome. Make sure you are visiting this link from the system that is running the OpenHIM-core. Otherwise, replace <code>localhost</code> and <code>8080</code> with the appropriate OpenHIM-core server hostname and API port. You should see a message saying “<strong>Your connection is not private</strong>”. Click “Advanced” and then click “Proceed”. Once you have done this, you should see some JSON, you can ignore this and close the page. Ths will ignore the fact that the certificate is self-signed. Now, you should be able to go back to the Console login page and login. This problem will occur every now and then until you load a properly signed certificate into the OpenHIM-core server.</p></li></ul> <hr> <ul><li>Run fhir4-mojaloop openhim mediator (You need to have node version v16.14.2 installed)<div class="language- extra-class"><pre class="language-text"><code>cd openhim/mediators/openhim-mediator-fhir-mojaloop-poc
npm run startDev
</code></pre></div>Then you should see a log message in the console like “info: Successfully registered mediator!”</li> <li>Run Third party SDK stack<div class="language- extra-class"><pre class="language-text"><code>cd thirdparty-sdk
docker-compose up
</code></pre></div></li></ul> <hr> <p>That’s it, all the services are deployed.</p> <h3 id="configuring-openhim-channel"><a href="#configuring-openhim-channel" class="header-anchor">#</a> Configuring OpenHIM channel</h3> <ul><li>Open openHIM console on ‘http://localhost:9080’ with username ‘root@openhim.org’ and password ‘123456’ (As we changed to this in previous step)</li> <li>Goto ‘Mediators’ and click on the entry ‘openhim-mediator-fhir-mojaloop-poc’</li> <li>Click on the green ‘+’ icon there to create a channel. All the configuration for the channel is provided as default configuration in the mediator. So we don’t need to change the channel configuration.</li></ul> <h3 id="have-the-following-web-pages-ready-to-monitor-the-transaction"><a href="#have-the-following-web-pages-ready-to-monitor-the-transaction" class="header-anchor">#</a> Have the following web pages ready to monitor the transaction</h3> <ul><li>OpenHIM console: Login to the console and goto ‘Transaction Log’</li> <li>Run fhir4-mojaloop openhim mediator (You need to have node version v16.14.2 installed)</li> <li>Payee mobile app simulator: Open the URL http://localhost:6060/payeemobile and login with username ‘987654321’ and don’t need password</li> <li>Mojaloop Testing Toolkit Monitoring: Open the URL http://localhost:6060/admin/monitoring</li></ul> <h3 id="making-a-transfer-and-monitor-the-logs"><a href="#making-a-transfer-and-monitor-the-logs" class="header-anchor">#</a> Making a transfer and monitor the logs</h3> <ul><li>Execute the following HTTP request either from command line or from postman.<div class="language- extra-class"><pre class="language-text"><code>curl --location --request POST 'http://localhost:5001/fhir-mojaloop/sendmoney/fhir4-invoice' --header 'Content-Type: application/json' --data-raw '{
&quot;resourceType&quot;: &quot;Invoice&quot;,
&quot;id&quot;: &quot;b88e5a38-35ad-4d8c-aad3-44b4ace8c0b1&quot;,
&quot;identifier&quot;: [
    {
        &quot;type&quot;: {
            &quot;coding&quot;: [
                {
                    &quot;system&quot;: &quot;https://openimis.github.io/openimis_fhir_r4_ig/CodeSystem/openimis-identifiers&quot;,
                    &quot;code&quot;: &quot;UUID&quot;
                }
            ]
        },
        &quot;value&quot;: &quot;b88e5a38-35ad-4d8c-aad3-44b4ace8c0b1&quot;
    },
    {
        &quot;type&quot;: {
            &quot;coding&quot;: [
                {
                    &quot;system&quot;: &quot;https://openimis.github.io/openimis_fhir_r4_ig/CodeSystem/openimis-identifiers&quot;,
                    &quot;code&quot;: &quot;Code&quot;
                }
            ]
        },
        &quot;value&quot;: &quot;IV-UC-8156989548-105&quot;
    }
],
&quot;status&quot;: &quot;active&quot;,
&quot;type&quot;: {
    &quot;coding&quot;: [
        {
            &quot;system&quot;: &quot;https://openimis.github.io/openimis_fhir_r4_ig/CodeSystem/bill-type&quot;,
            &quot;code&quot;: &quot;policy&quot;,
            &quot;display&quot;: &quot;Policy&quot;
        }
    ]
},
&quot;recipient&quot;: {
    &quot;reference&quot;: &quot;Patient/D944AFE5-F1A9-45D1-BE82-7BE28719A7E1&quot;,
    &quot;type&quot;: &quot;Patient&quot;,
    &quot;identifier&quot;: {
        &quot;type&quot;: {
            &quot;coding&quot;: [
                {
                    &quot;system&quot;: &quot;https://openimis.github.io/openimis_fhir_r4_ig/CodeSystem/openimis-identifiers&quot;,
                    &quot;code&quot;: &quot;UUID&quot;
                }
            ]
        },
        &quot;value&quot;: &quot;D944AFE5-F1A9-45D1-BE82-7BE28719A7E1&quot;
    }
},
&quot;date&quot;: &quot;2022-04-22&quot;,
&quot;lineItem&quot;: [
    {
        &quot;chargeItemCodeableConcept&quot;: {
            &quot;coding&quot;: [
                {
                    &quot;system&quot;: &quot;https://openimis.github.io/openimis_fhir_r4_ig/CodeSystem/bill-charge-item&quot;,
                    &quot;code&quot;: &quot;policy&quot;,
                    &quot;display&quot;: &quot;Policy&quot;
                }
            ]
        },
        &quot;priceComponent&quot;: [
            {
                &quot;extension&quot;: [
                    {
                        &quot;url&quot;: &quot;https://openimis.github.io/openimis_fhir_r4_ig//StructureDefinition/unit-price&quot;,
                        &quot;valueMoney&quot;: {
                            &quot;value&quot;: 2390.0,
                            &quot;currency&quot;: &quot;USD&quot;
                        }
                    }
                ],
                &quot;type&quot;: &quot;base&quot;,
                &quot;code&quot;: {
                    &quot;coding&quot;: [
                        {
                            &quot;system&quot;: &quot;Code&quot;,
                            &quot;code&quot;: &quot;Code&quot;,
                            &quot;display&quot;: &quot;IV-UC-8156989548-105&quot;
                        }
                    ]
                },
                &quot;factor&quot;: 1.0,
                &quot;amount&quot;: {
                    &quot;value&quot;: 2390.0,
                    &quot;currency&quot;: &quot;USD&quot;
                }
            }
        ]
    }
],
&quot;totalNet&quot;: {
    &quot;value&quot;: 2390.0,
    &quot;currency&quot;: &quot;USD&quot;
},
&quot;totalGross&quot;: {
    &quot;value&quot;: 2390.0,
    &quot;currency&quot;: &quot;USD&quot;
}
</code></pre></div></li></ul> <p>}’</p> <div class="language- extra-class"><pre class="language-text"><code>- You should get the 'Completed' status in the response and 'transactionRequestState' should be 'ACCEPTED' in the approveResponse body parameter.
- Open openHIM console on 'http://localhost:9080' with username 'root@openhim.org' and password '123456' (As we changed to this in previous step)
- Goto &quot;Transaction Log&quot; and you can find the transaction there.
- You can check various requests and response in TTK UI http://localhost:6060
- You should see the incoming notification in payee mobile app simulator
</code></pre></div></div>  <!----></main></div></div><div class="global-ui"><!----></div></div>
    <script src="/payments-interoperability-layer/assets/js/app.53bea330.js" defer></script><script src="/payments-interoperability-layer/assets/js/3.18f6b80e.js" defer></script><script src="/payments-interoperability-layer/assets/js/15.6423f441.js" defer></script>
  </body>
</html>
